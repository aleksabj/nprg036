# Movies per year with average duration

PREFIX ex:      <http://example.org/vocabulary/>
PREFIX schema:  <http://schema.org/>
PREFIX xsd:     <http://www.w3.org/2001/XMLSchema#>

SELECT ?year
       (COUNT(DISTINCT ?movie) AS ?moviesCount)
       (ROUND(AVG(xsd:integer(?mins))) AS ?avgMinutes)
WHERE {
  ?movie a schema:Movie ;
         schema:datePublished ?year ;
         ex:durationMinutes ?mins .
}
GROUP BY ?year
ORDER BY xsd:integer(?year)
